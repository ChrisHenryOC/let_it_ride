# Output Formats

This guide explains the output files generated by the simulator.

## Output Directory Structure

After running a simulation, results are saved to the output directory:

```
results/
  simulation_20241215_143022.json     # Full results (JSON)
  simulation_20241215_143022.csv      # Session summaries (CSV)
  simulation_20241215_143022.html     # HTML report (if enabled)
  simulation_20241215_143022_aggregate.csv  # Aggregate stats
  charts/
    session_outcomes.png              # Visualizations
    bankroll_trajectory.png
```

## JSON Output

The JSON file contains complete simulation results.

### Structure

```json
{
  "metadata": {
    "timestamp": "2024-12-15T14:30:22Z",
    "version": "1.0.0",
    "duration_seconds": 45.2
  },
  "config": {
    // Full configuration used (if include_config: true)
  },
  "summary": {
    "total_sessions": 100000,
    "winning_sessions": 38234,
    "losing_sessions": 61432,
    "push_sessions": 334,
    "session_win_rate": 0.382,
    "total_hands": 15234567,
    "average_hands_per_session": 152.3
  },
  "statistics": {
    "expected_value_per_hand": -0.0234,
    "variance": 125.67,
    "standard_deviation": 11.21,
    "skewness": -0.45,
    "confidence_interval_95": [-12.89, -11.45]
  },
  "hand_distribution": {
    "royal_flush": { "count": 23, "expected": 25, "ratio": 0.92 },
    "straight_flush": { "count": 456, "expected": 450, "ratio": 1.01 },
    // ... other hands
  },
  "sessions": [
    // Per-session details (if include_sessions: true)
  ]
}
```

### Configuration

```yaml
output:
  formats:
    json:
      enabled: true
      pretty: true           # Human-readable formatting
      include_config: true   # Include full config in output
```

## CSV Output

CSV files for spreadsheet analysis.

### Session Summary CSV

Each row is one session:

| Column | Description |
|--------|-------------|
| session_id | Unique identifier |
| starting_bankroll | Initial bankroll |
| ending_bankroll | Final bankroll |
| net_result | Profit/loss |
| hands_played | Total hands |
| stop_reason | Why session ended |
| peak_bankroll | Highest reached |
| max_drawdown | Largest decline |
| outcome | win/loss/push |

### Aggregate Statistics CSV

Summary statistics across all sessions:

| Column | Description |
|--------|-------------|
| metric | Statistic name |
| value | Calculated value |

### Per-Hand CSV (Optional)

Detailed per-hand data (large files):

| Column | Description |
|--------|-------------|
| hand_id | Unique hand ID |
| session_id | Parent session |
| player_cards | 3 player cards |
| community_cards | 2 community cards |
| decision_bet1 | ride/pull |
| decision_bet2 | ride/pull |
| final_hand | Evaluated hand |
| payout | Amount won/lost |

### Configuration

```yaml
output:
  formats:
    csv:
      enabled: true
      include_hands: false      # Per-hand details (large!)
      include_sessions: true    # Session summaries
      include_aggregate: true   # Overall statistics
```

## HTML Report

Interactive HTML report with embedded charts.

### Features

- Summary statistics table
- Session outcome histogram
- Bankroll trajectory charts
- Hand frequency comparison
- Strategy performance metrics

### Configuration

```yaml
output:
  formats:
    html:
      enabled: true
      include_charts: true
      chart_library: "plotly"  # Interactive charts
      # OR
      chart_library: "matplotlib"  # Static images
```

## Visualizations

Charts can be generated as standalone files.

### Session Outcomes Histogram

Distribution of session profit/loss:

```yaml
visualizations:
  charts:
    - type: "session_outcomes_histogram"
      title: "Distribution of Session Outcomes"
```

### Bankroll Trajectory

Sample session bankroll over time:

```yaml
visualizations:
  charts:
    - type: "bankroll_trajectory"
      title: "Sample Bankroll Trajectories"
      sample_sessions: 100  # Number of sessions to plot
```

### Hand Frequency

Actual vs. theoretical hand distribution:

```yaml
visualizations:
  charts:
    - type: "hand_frequency"
      title: "Hand Frequency vs. Theoretical"
```

### Configuration

```yaml
output:
  visualizations:
    enabled: true
    format: "png"   # png, svg, html
    dpi: 150        # Resolution
    charts:
      - type: "session_outcomes_histogram"
      - type: "bankroll_trajectory"
        sample_sessions: 100
      - type: "hand_frequency"
```

## Console Output

Real-time progress and summary display.

### Verbosity Levels

| Level | Output |
|-------|--------|
| 0 | Errors only |
| 1 | Progress bar + summary |
| 2 | + Per-session updates |
| 3 | + Debug information |

### Configuration

```yaml
output:
  console:
    progress_bar: true
    verbosity: 1
    show_summary: true
```

### Quiet Mode

Minimal output via CLI:

```bash
poetry run let-it-ride run config.yaml --quiet
```

## Working with Results

### Python Analysis

```python
import json
import pandas as pd

# Load JSON results
with open("results/simulation.json") as f:
    results = json.load(f)

print(f"Win rate: {results['summary']['session_win_rate']:.1%}")

# Load CSV for pandas analysis
sessions = pd.read_csv("results/simulation.csv")
print(sessions.describe())
```

### Excel/Sheets

CSV files open directly in spreadsheet applications for:
- Filtering and sorting sessions
- Creating custom charts
- Pivot table analysis

## File Naming

Output files are named: `{prefix}_{timestamp}.{format}`

Customize via:

```yaml
output:
  prefix: "my_simulation"
  timestamp_format: "%Y%m%d_%H%M%S"
```

## Next Steps

- [Configuration Reference](configuration.md) - All output options
- [Examples](examples.md) - Analysis workflows
- [API Documentation](api.md) - Programmatic access to results
